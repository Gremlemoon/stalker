#!/usr/bin/env ruby

require File.dirname(__FILE__) + '/../lib/stalker'

usage = "stalk <jobs.rb> [<priority>[,<priority>,..]]"
file = ARGV.shift or abort usage
priorities = (ARGV.shift || 'all').split(',')

require file

jobs = Stalker.jobs(priorities)
puts "Working #{jobs.size} #{priorities.join(', ')} priority jobs: [ #{jobs.join(' ')} ]"

trap('INT') do
	puts "\rExiting"
	exit
end

Stalker.work priorities

